{% load i18n %}

<div class="flex flex-col md:flex-row justify-between items-stretch md:items-center gap-3">
    <!-- Items per page selector and counter -->
    <div class="flex flex-col sm:flex-row items-stretch sm:items-center gap-3">
        <div class="flex items-center gap-2">
            <span class="text-sm" style="color: var(--ion-color-medium);">{% trans "Mostrar" %}:</span>
            <select
                name="per_page"
                class="h-9 px-3 rounded-lg text-sm"
                style="border: 1px solid var(--ion-border-color); background: var(--ion-background-color); color: var(--ion-text-color);"
                hx-get="{{ request.path }}"
                hx-target="#sales-table-container"
                hx-include="[name='search'],[name='order_by'],[name='date_from'],[name='date_to'],[name='status']"
                hx-push-url="true">
                <option value="10" {% if request.GET.per_page == '10' %}selected{% endif %}>10</option>
                <option value="25" {% if request.GET.per_page == '25' or not request.GET.per_page %}selected{% endif %}>25</option>
                <option value="50" {% if request.GET.per_page == '50' %}selected{% endif %}>50</option>
            </select>
        </div>

        {% if page_obj.paginator.count > 0 %}
        <div class="text-sm" style="color: var(--ion-color-medium);">
            {% trans "Mostrando" %} {{ page_obj.start_index }}â€“{{ page_obj.end_index }} {% trans "de" %} {{ page_obj.paginator.count }}
        </div>
        {% endif %}
    </div>

    <!-- Pagination buttons -->
    {% if page_obj.has_other_pages %}
    <div class="flex gap-1 justify-center md:justify-end flex-wrap">
        <!-- Previous button -->
        {% if page_obj.has_previous %}
        <ion-button
            size="large"
            fill="outline"
            hx-get="{{ request.path }}"
            hx-target="#sales-table-container"
            hx-include="[name='search'],[name='order_by'],[name='per_page'],[name='date_from'],[name='date_to'],[name='status']"
            hx-vals='{"page": {{ page_obj.previous_page_number }}}'
            hx-push-url="true">
            <ion-icon slot="icon-only" name="chevron-back-outline"></ion-icon>
        </ion-button>
        {% else %}
        <ion-button size="large" fill="outline" disabled>
            <ion-icon slot="icon-only" name="chevron-back-outline"></ion-icon>
        </ion-button>
        {% endif %}

        <!-- Page numbers -->
        {% for page_num in page_obj.paginator.page_range %}
            {% if page_num == page_obj.number %}
                <ion-button size="large" fill="solid" color="primary">
                    {{ page_num }}
                </ion-button>
            {% elif page_num > page_obj.number|add:'-3' and page_num < page_obj.number|add:'3' %}
                <ion-button
                    size="large"
                    fill="outline"
                    hx-get="{{ request.path }}"
                    hx-target="#sales-table-container"
                    hx-include="[name='search'],[name='order_by'],[name='per_page'],[name='date_from'],[name='date_to'],[name='status']"
                    hx-vals='{"page": {{ page_num }}}'
                    hx-push-url="true">
                    {{ page_num }}
                </ion-button>
            {% elif page_num == 1 or page_num == page_obj.paginator.num_pages %}
                <ion-button
                    size="large"
                    fill="outline"
                    hx-get="{{ request.path }}"
                    hx-target="#sales-table-container"
                    hx-include="[name='search'],[name='order_by'],[name='per_page'],[name='date_from'],[name='date_to'],[name='status']"
                    hx-vals='{"page": {{ page_num }}}'
                    hx-push-url="true">
                    {{ page_num }}
                </ion-button>
            {% elif page_num == page_obj.number|add:'-3' or page_num == page_obj.number|add:'3' %}
                <span class="flex items-center px-2 text-sm" style="color: var(--ion-color-medium);">...</span>
            {% endif %}
        {% endfor %}

        <!-- Next button -->
        {% if page_obj.has_next %}
        <ion-button
            size="large"
            fill="outline"
            hx-get="{{ request.path }}"
            hx-target="#sales-table-container"
            hx-include="[name='search'],[name='order_by'],[name='per_page'],[name='date_from'],[name='date_to'],[name='status']"
            hx-vals='{"page": {{ page_obj.next_page_number }}}'
            hx-push-url="true">
            <ion-icon slot="icon-only" name="chevron-forward-outline"></ion-icon>
        </ion-button>
        {% else %}
        <ion-button size="large" fill="outline" disabled>
            <ion-icon slot="icon-only" name="chevron-forward-outline"></ion-icon>
        </ion-button>
        {% endif %}
    </div>
    {% endif %}
</div>
